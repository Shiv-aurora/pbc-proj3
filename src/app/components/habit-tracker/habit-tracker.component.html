<div class="habit-tracker">
  <!-- Add Habit Button -->
  <div class="add-habit-header">
    <button class="btn-add-habit" (click)="toggleAddForm()">
      {{ showAddForm ? 'âœ• Cancel' : '+ Add New Habit' }}
    </button>
  </div>

  <!-- Add Habit Form -->
  @if (showAddForm) {
    <div class="add-habit-form">
      <form [formGroup]="habitForm" (ngSubmit)="onSubmit()">
        <div class="form-group">
          <label for="name">Habit Name *</label>
          <input
            type="text"
            id="name"
            formControlName="name"
            placeholder="e.g., Drink 8 glasses of water"
            class="form-control"
            [class.error]="formName?.invalid && formName?.touched"
            />
            @if (formName?.invalid && formName?.touched) {
              <div class="error-message">
                @if (formName?.errors?.['required']) {
                  <span>Habit name is required</span>
                }
                @if (formName?.errors?.['minlength']) {
                  <span>Habit name must be at least 2 characters</span>
                }
              </div>
            }
          </div>
          <button type="submit" class="btn-submit" [disabled]="habitForm.invalid">
            Add Habit
          </button>
        </form>
      </div>
    }

    <!-- Habits List -->
    @if (habits.length > 0) {
      <div class="habits-list">
        @for (habit of habits; track habit) {
          <div class="habit-card">
            <div class="habit-info">
              <div class="habit-checkbox-container">
                <input
                  type="checkbox"
                  [id]="'habit-' + habit.id"
                  [checked]="isCompletedToday(habit.id)"
                  (change)="toggleHabit(habit.id)"
                  class="habit-checkbox"
                  />
                  <label [for]="'habit-' + habit.id" class="habit-label">
                    <span class="habit-name" [class.completed]="isCompletedToday(habit.id)">
                      {{ habit.name }}
                    </span>
                    @if (habit.description) {
                      <span class="habit-description">
                        {{ habit.description }}
                      </span>
                    }
                  </label>
                </div>
                <button class="btn-delete" (click)="deleteHabit(habit.id)" title="Delete habit">
                  ğŸ—‘ï¸
                </button>
              </div>
              <!-- 7-Day Chart -->
              <div class="habit-chart-container">
                <app-habit-chart [habitId]="habit.id"></app-habit-chart>
              </div>
            </div>
          }
        </div>
      }

      <!-- Empty State -->
      @if (habits.length === 0 && !showAddForm) {
        <div class="empty-state">
          <div class="empty-icon">ğŸ“‹</div>
          <p>No habits yet. Start building healthy habits today!</p>
          <button class="btn-primary" (click)="toggleAddForm()">
            Add Your First Habit
          </button>
        </div>
      }
    </div>
